<!DOCTYPE html>
<html lang="zh-CN">
 
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<title>HTML5+QT</title>
	<meta name="keywords" content="" />
	<meta name="description" content="" /> 
</head>
 
<body>
 
	<div class="limiter">
		<div class="container-login100" style="background-image: url('images/bg-01.jpg');">
			<div class="wrap-login100 p-l-55 p-r-55 p-t-65 p-b-54">
				<form class="login100-form validate-form">

					<div class="container-login100-form-btn">
						<div class="wrap-login100-form-btn">
							<div class="login100-form-bgbtn"></div>
							<button class="login100-form-btn" id = "web_login">网页取证</button>
						</div>
					</div>
					
					<div class="container-login100-form-btn">
						<div class="wrap-login100-form-btn">
							<div class="login100-form-bgbtn"></div>
							<button class="login100-form-btn" id = "camera_login">拍摄取证</button>
						</div>
					</div>
 
 					<div class="container-login100-form-btn">
						<div class="wrap-login100-form-btn">
							<div class="login100-form-bgbtn"></div>
							<button class="login100-form-btn" id = "record_login">录屏取证</button>
						</div>
					</div>
					
					<div class="container-login100-form-btn">
						<div class="wrap-login100-form-btn">
							<div class="login100-form-bgbtn"></div>
							<button class="login100-form-btn" id = "screenshot_login">截图取证</button>
						</div>
					</div>
 
				</form>
			</div>
		</div>
	</div>
	<script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
	<script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.min.js"></script>
	<script type="text/javascript"> 
	window.onload = function() {  
            new QWebChannel(qt.webChannelTransport, function(channel) {    //浏览器内核自带
				var strToken = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NDY2OTUzMzksInVzZXIiOnsicGFzc3dvcmQiOm51bGwsInVzZXJuYW1lIjoi5a6i5oi356uv5rWL6K-V55So5oi3IiwiZW5hYmxlZCI6dHJ1ZSwidXNlciI6eyJpZCI6IjY1MjkwMzA3NTYwMTk4MTQ0MCIsInVzZXJuYW1lIjoi5a6i5oi356uv5rWL6K-V55So5oi3IiwicGFzc3dvcmQiOm51bGwsImVtYWlsIjoiaGIuZmVuZ3l1Z2FuZ0BhaXNpbm8uY29tIiwibW9iaWxlIjpudWxsLCJlbmFibGVkIjp0cnVlLCJpc0FkbWluIjpmYWxzZSwiaXNEZWxldGUiOiIxIiwicHdkUmVzZXRUaW1lIjpudWxsLCJzbTRQYXNzd29yZCI6bnVsbCwiY2VydCI6bnVsbCwiZW5jcnlwdENlcnQiOm51bGwsImxpY2Vuc2VVcmwiOm51bGwsImNyZWF0ZVRpbWUiOjE2Mzg4NjQyMjQwMDAsInVwZGF0ZVRpbWUiOjE2NDY2NDM4NDAwMDAsImF1dGhlbnRpY2F0aW9uSW5mb0lkIjo2NTI5MDMwNzU5ODM2NjMxMDQsImlzQXBwbHlDZXJ0IjoiMSIsImF1dGhlbnRpY2F0aW9uU3RhdHVzIjoiMDIiLCJzaWduUHVibGljS2V5IjoiMDQ4Y2RmOTE1MTM1Y2ZmNGE5OTcwMjZmZTc4ZTU3NDQwZGNhNTJlM2UyZDRiMDc3ZWM0MWQyODdjZmRhNTkzM2YwY2JlYzEyZThlMWIxMDg4MWJmMTAzZDFmNTgyNGJhZGYzMDBmNzM0OWY3ZGUxMTFhOThjZTRiNDRlOGU1ODVjYyIsImVuY3J5cHRQdWJsaWNLZXkiOiIwNGJkNzQ0OGJmMzAyNWVkMmU4ZDEwZDIyZGJmYTE2YmUxYWMyYjNlZDdlYTg3NGNjN2FlYWFmYTJlYjYwN2RkNGU0ZjM4YzU3YjQ1ZWM3YTRkZDI4NGMzMzQ2NzlhYmNmOWJkNTFkMDE2NDE0YmRhMmY0NmM4OWFlYTQzY2E4NjQxIiwidG9TaWduZWQiOm51bGwsInJlYXNvbiI6bnVsbH0sInJvbGVzIjpbXX0sInVzZXJfbmFtZSI6IuWuouaIt-err-a1i-ivleeUqOaItyIsImp0aSI6ImI3MTcwOWUxLTNmNmEtNDcxNy04NWFlLTVkOTlhOWRjNmI2ZiIsImNsaWVudF9pZCI6ImFtcyIsInNjb3BlIjpbImFtcyJdfQ.WiIbyGX8EUztrc5govpJemGymCfJDgIa4jirR-yrxkVVOpI4Z4kZKykaSKoQEv64zhdQ_VZm60lYS8t3dytuV91usropOgd15B5zTolyOXlUZFV7WrQ0Uc_5CIfg7Phb5CQAOFwcaio8SajnuveWbg_XAHFsX3qMwBOrJIDJIN9tR-5vH5QtaYJyi8RshAtVsKkFJTbLHuXsU-QJ28v0ahq-aieh6IgfBXAqc5vG-naLQPZDTf8nluRSVGXMQBJMrfU-nAn0cnMcWKMrnP_KxoSoHKUFtkwIeo0o5zy2K0YYsoB3XIw1pQSj3DUsTksvOWt_SHL8aQONt6RpmLjLCQ"
                //Get Qt interact object  
                var interactObj = channel.objects.interactObj;      //注册对象名
                //Web send message to Qt 
				$("#web_login").click(function(){
					var msg = new Object();
					msg.type = "web_login";
					msg.name = "网页取证测试"
					msg.url = "http://www.baidu.com"
					msg.token = strToken
					var json = JSON.stringify(msg);
					interactObj.JSSendMessage(json,"","");
				})
				
				$("#camera_login").click(function(){
					var msg = new Object();
					msg.type = "camera_login";
					msg.name = "拍摄取证测试"
					msg.token = strToken
					var json = JSON.stringify(msg);
					interactObj.JSSendMessage(json,"","");
				})
				
				$("#record_login").click(function(){
					var msg = new Object();
					msg.type = "record_login";
					msg.name = "录屏取证测试"
					msg.token = strToken
					var json = JSON.stringify(msg);
					interactObj.JSSendMessage(json,"","");
				})
				
				$("#screenshot_login").click(function(){
					//var msg = new Object();
					//msg.type = "screenshot_login";
					//msg.name = "截图取证测试"
					//msg.token = strToken
					//var json = JSON.stringify(msg);
					//interactObj.JSSendMessage(json,"","");
					
					var msg = new Object();
					msg.type = "sm4";
					//msg.encry = "va73dVJ4MbRqx6ihNissDg=="
					msg.encry = "I5Zfz235g7H37KKdoE0ruVHKhBE/6yR99rDLQlbTC8u9pobmy325JBbmosjIljlKyzqkX9mbiysmW1zWzke0wBWlLZt364al2qXrQ6Ky9Ie2Jz9uu4rSeVYivmtR+WI9/XLhEAYr2MHrO/xSNEHPrQ=="
					//msg.key = "1111111111111111"
					msg.key = "86c6774851885dde";
					msg.state = "start";
					msg.filename = "";
					msg.batchSingle = "batch";//批量为：batch；单次为：single
					//msg.state = "finish";
					//msg.state = "rstart";
					var json = JSON.stringify(msg);
					interactObj.JSSendMessage(json,"","");
					
					//var msg = new Object();
					//msg.type = "forensicsPath";
					//msg.mode = "web_forensics"
					//msg.mode = "camera_forensics"
					//msg.mode = "record_forensics"
					//msg.mode = "screenshot_forensics"
					//var json = JSON.stringify(msg);
					//interactObj.JSSendMessage(json,"","");
					
					//var msg = new Object();
					//msg.type = "tokenInvalidat";
					//var json = JSON.stringify(msg);
					//interactObj.JSSendMessage(json,"","");
					
					//var msg = new Object();
					//msg.type = "openResourceManagement";
					//msg.path = "F:/work/code/ElectronicDepository/PartChainElectronic/build-PartChainClient-Desktop_Qt_5_12_9_MSVC2017_32bit-Release/release/OutPut";
					//var json = JSON.stringify(msg);
					//interactObj.JSSendMessage(json,"","");
					
					//var msg = new Object();
					//msg.type = "openResourceManagement";
					//msg.path = "C:/Users/fyg/Downloads";
					//var json = JSON.stringify(msg);
					//interactObj.JSSendMessage(json,"","");
				})

                //Web connect the Qt signal, then Qt can call "output" function
                interactObj.SigSendMessageToJS.connect(function(str,str2,str3) {       //接收信号，响应函数
					var strJson = JSON.parse(str);
					for(var key in strJson)
					{
						if(key == "strMain")
						{
							var jStrMain = strJson[key];
						}
						else if(key == "strBranch")
						{
							var jStrBranch = strJson[key];
						}
						else if(key == "str")
						{
							var jStr = strJson[key];
						}
						else if(key == "path")
						{
							var jPath = strJson[key];
						}
						else if(key == "hostIp")
						{
							var jHostIp = strJson[key];
						}
						else if(key == "ipAddress")
						{
							var jIpAddress = strJson[key];
						}
						else if(key == "macAddress")
						{
							var jMacAddress = strJson[key];
						}
						else if(key == "osVersion")
						{
							var jOsVersion = strJson[key];
						}
						else if(key == "forensicsPath")
						{
							var jForensicsPath = strJson[key];
						}
					}
					
					if(jStrMain == "GetWebDate")
					{
						if(jStrBranch == "token")
						{
							//alert(str3);
							alert(jStr);
						}
						else if(jStrBranch == "cancel")
						{
							//alert(str3);
						}
						else if(jStrBranch == "hostIp")
						{
							alert(jHostIp);
						}
						else if(jStrBranch == "cleanFail")
						{
							//网络清洁性检测失败
						}
					}
					else if(jStrMain == "GetCameraDate")
					{
						if(jStrBranch == "token")
						{
							alert(jStr);
							//alert(str3);
						}
						else if(jStrBranch == "cancel")
						{
							//alert(str3);
						}
						else if(jStrBranch == "cleanFail")
						{
							//网络清洁性检测失败
						}
					}
					else if(jStrMain == "GetRecordDate")
					{
						if(jStrBranch == "token")
						{
							alert(jStr);
							//alert(str3);
						}
						else if(jStrBranch == "cancel")
						{
							//alert(str3);
						}
						else if(jStrBranch == "cleanFail")
						{
							//网络清洁性检测失败
						}
					}
					else if(jStrMain == "GetScreenshotDate")
					{
						if(jStrBranch == "token")
						{
							alert(jStr);
							//alert(str3);
						}
						else if(jStrBranch == "cancel")
						{
							//alert(str3);
						}
						else if(jStrBranch == "cleanFail")
						{
							//网络清洁性检测失败
						}
					}
					else if(jStrMain == "sm4")
					{
						if(jStrBranch == "JsSegmentSend")
						{
							
						}
						else if(jStrBranch == "JsSegmentRecvStart")
						{
							
						}
						else if(jStrBranch == "JsSegmentRecvFinish")
						{
							//alert(jStr);
						}
						else if(jStrBranch == "JsRecvAll")
						{
							
						}						
					}
					else if(jStrMain == "forensicsMode")
					{
						alert(jForensicsPath);
					}
			});
            });  
            }  
 
 
 
	</script>  
</body>
 
</html>